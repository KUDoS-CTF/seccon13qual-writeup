# self-ssrf
`/flag` というエンドポイントに`flag`パラメータにフラグの値を指定してリクエストを送信することで、レスポンスにフラグが返ってくる。

 `/ssrf` というエンドポイントでは、`searchParams.append()`を利用して `flag` パラメータにフラグの値を設定して `/flag` エンドポイントへリクエストを送信する。

 しかし、ミドルウェアの制約によって、 `flag` パラメータを付与したリクエスト以外は上記のエンドポイントに到達することがない。 `flag` パラメータを付与してしまうと、 `/ssrf` エンドポイントの処理で付与された正しいフラグの値を `/flag` 側でのフラグの値判定に利用できない。

 これを回避するため、 `flag` パラメータに下記のような値を指定する。
 ```
 /ssrf?&flag[=]=hoge
 ```

 これに対して、`searchParams.append()` を実行すると、下記のようにURLエンコードが発生する。
 ```
 /ssrf?flag%5B=%5D%3Dhoge&flag=SECCON{
 ```
 
 これにより、最初に付与した `flag[=]=hoge` の部分は、 `flag%5B` をキーとした値としてパースされ、 `flag` パラメータにはこの処理で付与されたフラグの値が用いられる。よって `/flag` エンドポイントからフラグの値を取得できる条件を満たし、フラグを獲得できる。　